# Домашнее задание Куприянова Ю.В., к занятию «Базы данных, их типы».

### Задание 1. СУБД

### Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать 
правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для
каждой предметной области. 

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему? 
 
---
1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков.
СУБД должна гарантировать целостность и чёткую структуру данных.

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы? 

---
#### ОТВЕТ:
1.1. Реляционная СУБД (например, PostgreSQL, MySQL, Microsoft SQL Server).
Реляционная СУБД обеспечивают строгую структуру данных и целостность, поддерживают транзакции и сложные SQL-запросы, что критично для бюджетирования, финансовых отчётов и прогнозирования рисков. Это позволит эффективно управлять данными, предотвращать несоответствия и обеспечивать соответствие стандартам финансовой отчётности.

1.1. Предположу, что для ускорения API можно использовать Redis в качестве кэша. Redis поддерживает быструю работу с хэшами и может существенно снизить нагрузку на основную СУБД.

---
1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к 
маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? 
СУБД должны быть гибкими и быстрыми.

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?

---
#### ОТВЕТ:
1.2. NoSQL, например, MongoDB.
Так как лендинги часто работают с неструктурированными или полуструктурированными данными (например, формы обратной связи, поведенческие данные пользователей), лучше всего подойдет NoSQL-СУБД гибкие, поддерживают динамические схемы и хорошо масштабируются.
А для CRM реляционная СУБД, например, PostgreSQL или Microsoft SQL Server, так как CRM-системы часто требуют сложных аналитических запросов, транзакционной целостности и интеграции с другими корпоративными системами. Реляционные СУБД лучше подходят для структурированных данных и сложных отчётов.

1.2.* Теоретически можно использовать одну СУБД, например MongoDB, если гибкость и масштабируемость важнее строгой структуры данных. Однако для CRM может потребоваться дополнительная логика для обеспечения транзакционной целостности и сложных аналитических возможностей. Оптимальным решением может быть гибридный подход: использовать NoSQL для лендингов и реляционную СУБД для CRM.

---
1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу 
и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это 
реализовать?

---
#### ОТВЕТ:
1.3. Для базы по корпоративным нормам и правилам подойдет реляционная СУБД, например, PostgreSQL. Она хорошо подходит для хранения структурированных данных с чёткими связями и иерархией. Это удобно для организации данных о корпоративных нормах, правилах и обучающем материале.

1.3.* Можно использовать ту же реляционную СУБД, что и для бюджетирования, PostgreSQL. Это упростит интеграцию данных и снизит затраты на поддержку нескольких систем.

---

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов 
по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать
со связями.

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД 
логистов?

---
#### ОТВЕТ:
1.4. Под задачи логистики подойдет графовая СУБЛ, например Neo4j. Графовые СУБД специально разработаны для работы с данными, имеющими сложные связи. Они эффективно моделируют отношения между объектами (например, точками доставки, материалами, курьерами), что критично для задач маршрутизации и распределения ресурсов. 
1.4.* Можно подключить отдел закупок к той же графовой СУБД, так как графовые модели позволяют гибко представлять и анализировать связи между материалами, поставщиками, заказами и другими приложениями. Однако если у отдела закупок есть уникальные требования к хранению и обработке данных, которые не пересекаются с задачами логистики, возможно, что будет лучше создать отдельную СУБД. 

---

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

----
#### ОТВЕТ:
Единая СУБД для всех задач - это мультимодельная СУБД ArangoDB. Эта СУБД поддерживает графовую, реляционную и ключ-значение модели данных. Это позволяет эффективно решать задачи из разных предметных областей.

---

### Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы 
транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

*Приведите ответ в свободной форме.*

---
#### ОТВЕТ:
2.1. Пошаговый алгоритм транзакции:
1. Инициация платежа. Пользователь выбирает способ пополнения (мобильное приложение банка, терминал, сайт оператора и т. п.) и вводит: 
- номер телефона;
- сумму пополнения;
- реквизиты платёжного средства (номер карты, электронного кошелька и др.).

2. Проверка данных и авторизация. Система:
- верифицирует корректность введённых данных (номер телефона, сумма, платёжные реквизиты);
- запрашивает у пользователя подтверждение (SMS‑код, биометрию, PIN);
- проверяет достаточность средств на платёжном средстве.
3. Блокировка суммы. Система временно блокирует указанную сумму на счёте плательщика (чтобы исключить двойной расход или недостаток средств).
4. Отправка запроса оператору связи. Система передаёт оператору связи данные платежа (номер телефона, сумма, идентификатор транзакции).
5. Обработка оператором. Оператор:
- проверяет допустимость пополнения (корректность номера, лимиты);
- зачисляет сумму на баланс указанного номера;
- формирует подтверждение успешного зачисления.
6. Финализация транзакции. Система:
- снимает блокировку и списывает сумму со счёта плательщика;
- фиксирует транзакцию в истории платежей;
- отправляет пользователю уведомление о успешном пополнении или об отказе в операции (SMS, push, email).

2.1.* Пополнение через автоплатёж
Алгоритм при автоплатеже (срабатывает по условию: заданный баланс на счете телефона / регулярная дата / определенное время):
1. Срабатывание условия. Когда баланс достигает заданного порога (например, ≤ 30 руб.) или наступает запланированная дата платежа, или определённое время, система инициирует автоплатёж.
2. Мониторинг баланса. Система постоянно отслеживает баланс указанного номера телефона (например, раз в час).
3. Проверка платёжных данных. Система извлекает из профиля пользователя:
- сохранённый способ оплаты (привязанная карта, кошелёк);
- сумму пополнения (фиксированная или расчётная);
- дополнительные параметры (лимиты, комментарии).
4. Авторизация и блокировка. Система:
- проверяет актуальность платёжных данных (срок карты, статус кошелька);
- блокирует сумму на счёте плательщика.
5. Взаимодействие с оператором. Система отправляет оператору запрос на пополнение с параметрами транзакции.
6. Зачисление и финализация. Оператор зачисляет средства на номер, система:
- списывает сумму со счёта плательщика;
- обновляет историю платежей;
- тправляет пользователю уведомление о успешном пополнении или об отказе в операции (SMS, push, email).


---

### Задание 3. SQL vs NoSQL

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL. 

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

*Приведите ответ в свободной форме.*

---
#### ОТВЕТ:
![Скриншот-1](https://github.com/Yuriykup/Netology_10-01-hw/blob/main/img/img1.png)

3.1 Пять преимуществ SQL‑систем перед NoSQL:
- Строгая согласованность данных (ACID‑гарантия).
SQL‑системы обеспечивают полную поддержку ACID (атомарность, согласованность, изоляция, долговечность). Это критично для финансовых операций, учёта и других сценариев, где недопустимы расхождения. NoSQL‑системы часто идут на компромиссы (модель BASE), допуская временную несогласованность.
- Чёткая схема данных (rigid schema).
Предварительное определение структуры таблиц, типов полей и ограничений (NOT NULL, UNIQUE, FOREIGN KEY) снижает риск ошибок ввода, обеспечивает целостность связей и упрощает поддержку. В NoSQL схема гибкая (schema‑free), что повышает риск неструктурированных или некорректных данных.
- Мощные инструменты для сложных запросов.
SQL поддерживает JOIN, подзапросы, оконные функции, агрегации с GROUP BY и HAVING. Это позволяет анализировать связанные данные из нескольких таблиц в одном запросе. В NoSQL для аналогичных задач часто требуется множественные запросы и постобработка на стороне приложения.
- Широкая экосистема инструментов и стандартов.
Существует огромное количество ORM (Hibernate, Entity Framework), BI‑систем (Tableau, Power BI), ETL‑инструментов (Apache NiFi, Talend), совместимых с SQL. Для NoSQL экосистема уже и часто привязана к конкретному движку (например, MongoDB Compass).
- Высокий уровень безопасности и аудита.
SQL‑системы предлагают детальные механизмы контроля доступа (роли, привилегии), поддержку шифрования на уровне столбцов, аудит операций и соответствие стандартам (PCI DSS, GDPR). В NoSQL настройка безопасности часто требует дополнительных усилий и сторонних решений.

3.1.* Преимущества NewSQL‑систем перед SQL и NoSQL
NewSQL‑системы (например, Google Spanner, CockroachDB, VoltDB) сочетают сильные стороны обоих подходов:
- ACID + горизонтальное масштабирование.
В отличие от классических SQL, которые масштабируются вертикально (дорогая «железная» модернизация), NewSQL поддерживает горизонтальное масштабирование (добавление узлов). При этом сохраняется полная ACID‑совместимость, что недоступно большинству NoSQL‑решений.
- Высокая производительность при большой нагрузке.
За счёт распределённой архитектуры и оптимизации для OLTP (онлайн‑транзакций) NewSQL обрабатывает тысячи транзакций в секунду без потери согласованности. Это превосходит возможности традиционных SQL‑СУБД при росте данных.
- Гибкость схемы с контролем целостности.
Некоторые NewSQL‑системы позволяют динамически изменять схему (как NoSQL), но при этом поддерживают ограничения и типы данных (как SQL). Это балансирует между жёсткой структурой и адаптивностью.
- Встроенная отказоустойчивость.
NewSQL автоматически реплицирует данные между узлами, обеспечивает восстановление после сбоев и геораспределённость без дополнительной настройки. В SQL это требует сложных кластерных решений, а в NoSQL — часто жертвует согласованностью.
- Совместимость с SQL‑стандартами.
NewSQL использует привычный SQL‑синтаксис и драйверы (JDBC/ODBC), что упрощает миграцию с традиционных SQL‑систем. При этом они решают проблемы масштабируемости, с которыми сталкиваются классические РСУБД.

---
### Задание 4. Кластеры
Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу 
выделено 1000 машин. 

На основе какого критерия будете выбирать тип СУБД и какая модель *распределённых вычислений* 
здесь справится лучше всего и почему?

*Приведите ответ в свободной форме.*

---
#### ОТВЕТ:
При выборе СУБД для кластера из ~1000 машин ключевой критерий — горизонтальная масштабируемость, позволяющая эффективно распределять нагрузку и хранить огромные объёмы данных. Для массовых вычислений оптимальна модель массово‑параллельной обработки (MPP). Из доступных решений лучше всего подойдут: 
- Apache Spark - высокая скорость итеративных расчётов и потоковой обработки за счёт вычислений в памяти;
- ClickHouse - экстремальная скорость аналитических запросов благодаря колоночному хранению и сжатию;
- Hadoop + MapReduce надёжная пакетная обработка петабайтов данных с высокой отказоустойчивостью;

Spark предпочтителен для машинного обучения и интерактивной аналитики, ClickHouse — для быстрой агрегации и отчётов, а Hadoop — для дешёвой пакетной обработки архивов при невысоких требованиях к задержкам.

---


